---
title: "Summary"
output: pdf_document
date: "`r format(Sys.time(), '%d %B, %Y')`"
knit: (function(inputFile, encoding) { 
      out_dir <- '../output';
      intermediates_dir <- '../output';
      clean <- TRUE;
      rmarkdown::render(inputFile,
                        encoding=encoding, 
                        output_file=file.path(dirname(inputFile), 
                        out_dir, 'summary.pdf')) })
header-includes: 
  - \usepackage{tikz}
  - \usepackage{pgfplots}
  - \usepackage{float}
  - \usepackage{bbm}
  - \floatplacement{figure}{H}
  - \floatplacement{table}{H}
  - \pgfplotsset{compat=1.16}
---

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=10, fig.height=6)
```

Assume that each county $i$ is a distinct market with population $S_i$ and let $N_i \in \{0,1,2\}$ denote
the number of big-box discount retailers (Kmart or Walmart) in the county. Assume that profits to a discount retailer in county $i$ are given by:

\[\pi(S_i,N_i,F_i) = S_iv(N_i) - F_i\]

Where $v()$ is per-capita variable profit, strictly decreasing in its argument, and $F_i$ is a fixed
cost distributed i.i.d. normal with mean$\mu$ and standard deviation $\sigma$ across counties. Importantly, this model treats Walmart and K-mart as identical and ignores other retailers. The
model also ignores the fact that Walmart and Kmart may coordinate their entry decisions across markets. 

## (a) Estimate the parameters of the model

With the assumptions given we have that:

\[
\begin{aligned}
& Prob(N_i^* = n) = Prob([\pi(S_i,n,F_i)\geq0] \cap [\pi(S_i,n+1,F_i)\leq0]) = \\
& = Prob(S_i v(n+1) \leq F_i \leq S_i v(n)) = Prob(F_i \leq S_i v(n)) - Prob(F_i \leq S_i v(n+1)) = \\
& = \Phi\Big(\frac{S_i v(n) - \mu}{\sigma}\Big) - \Phi\Big(\frac{S_i v(n+1) - \mu}{\sigma}\Big)
\end{aligned}
\]

Now, if we normalize $v(1) = 1$, and we note that $Prob(F_i \leq S_i v(0)) = 1$\footnote{One way to think about this is that $\lim_{n\to0} v(n) = \infty$.} we have that:

\[
\begin{aligned}
& Prob(N_i^* = 0) = 1 - \Phi\Big(\frac{S_i - \mu}{\sigma}\Big) \\
& Prob(N_i^* = 1) = \Phi\Big(\frac{S_i - \mu}{\sigma}\Big) - \Phi\Big(\frac{S_i v(2) - \mu}{\sigma}\Big) \\
& Prob(N_i^* = 2) = 1 - Prob(N_i^* = 0) -  Prob(N_i^* = 1)
\end{aligned}
\]

Then, the likelihood of the data is just:

\[
L = \prod_{i = 1}\prod_{n = 0}^2 Prob(N_i^* = n)^{\mathbbm{1}\{N_i^* = n\}}
\]

And the log-likelihood is just:

\[
ll = \sum_{i = 1}\sum_{n = 0}^2 \mathbbm{1}\{N_i^* = n\} \log(Prob(N_i^* = n))
\]

Where $i$ indexes counties. Now, we can maximize $ll$ with respect to $\mu, \sigma$ and $v(2)$ to get our ML estimates of the parameters. The results are displayed in the table below:

\begin{table}
\centering
\begin{tabular}{cc}
\hline
ML estimates \\ \hline\hline
$\mu$ & 25.071 \\ 
$\sigma$ & 14.800 \\ 
$v(2)$ & 0.288 \\
\hline\hline
\end{tabular}
\end{table}

## (b) Offer an economic interpretation of each parameterâ€™s magnitude.

The mean of the fixed cost distribution is around 25 times the monopolist per thousand people variable profits, and the standard deviation is about 14.8 times the latter. Note that the normality assumption implies that some counties have negative fixed costs. As for $v(2)$, the economic interpretation is that the per thousand people variable profits of a duopoly fall by 71.2\% as compared to the per thousand people variable profits of a monopoly. 

## (c) Re-estimate the model, but now assume that the mean of fixed costs is $\mu_1$ for the first entrant and $\mu_2 \geq \mu_1$ for the second entrant. Report the parameter values you estimate.

Now, we have that:

\[
\begin{aligned}
& Prob(N_i^* = 0) = 1 - \Phi\Big(\frac{S_i - \mu_1}{\sigma}\Big) \\
& Prob(N_i^* = 1) = \Phi\Big(\frac{S_i - \mu_1}{\sigma}\Big) - \Phi\Big(\frac{S_i v(2) - \mu_2}{\sigma}\Big) \\
& Prob(N_i^* = 2) = 1 - Prob(N_i^* = 0) -  Prob(N_i^* = 1)
\end{aligned}
\]

So we can write the likelihood and the log-likelihood as before but with these new probabilities. Now, we maximize with respect to $\mu_1, \mu_2, \sigma$ and $v(2)$. I have not imposed that $\mu_2 \geq \mu_1$ as the unconstrained maximization delivered exactly that. The results are displayed below:

\begin{table}
\centering
\begin{tabular}{cc}
\hline
ML estimates \\ \hline\hline
$\mu_1$ & 25.717 \\ 
$\mu_2$ & 52.307 \\ 
$\sigma$ & 18.871 \\ 
$v(2)$ & 0.938 \\
\hline\hline
\end{tabular}
\end{table}

## (d) How does your estimate of $v()$ change between (a) and (c)? Why?

Allowing for the second entrant to have a fixed cost with a different mean substantially changes the results. The average esimated fixed cost for the second entrant is around twice the one estimated for the first entrant, and therefore the per thousand people variable profits of a duopoly as compared with a monopoly falls by 6.2\% instead of by 71.2\%. Basically the predicted share of market of the second entrant in model (c) is much smaller than the one predicted by the model in (a), and so the competition over variable profits is also smaller. 

## (e) Return to the setting in part (a) but drop the assumption that $F_i$ is distributed normally. Instead, assume that $F_i$ is i.i.d. with a smooth CDF. Estimate v().

With this assumption we have that:

\[
\begin{aligned}
& Prob(N_i^* = 0|S_i) = 1 - \tilde\Phi\Big(S_i\Big) \\
& Prob(N_i^* = 1|S_i) = \tilde\Phi\Big(S_i\Big) - \tilde\Phi\Big(S_i v(2)\Big) \\
& Prob(N_i^* = 2|S_i) = 1 - Prob(N_i^* = 0|S_i) -  Prob(N_i^* = 1|S_i) \\
\end{aligned}
\]

Where $\tilde\Phi()$ denotes the i.i.d distribution of $F_i$. Therefore, we have that:

\[
\tilde\Phi\Big(S_i\Big) = 1-Prob(N_i^* = 0|S_i)
\]

And that:

\[
\tilde\Phi\Big(S_i v(2)\Big)  = 1-Prob(N_i^* = 0|S_i) - Prob(N_i^* = 1|S_i)
\]

And therefore we get that:

\[
v(2) = \frac{\tilde\Phi^{-1}\Big(1-Prob(N_i^* = 0|S_i) - Prob(N_i^* = 1|S_i)\Big)}{S_i}
\]

There are a lot of ways to estimate the $\tilde\Phi()$. I am going to do it piecewise linearly, therefore assuming that the CDF is almost-surely smooth and i.i.d. First, I bin the population in $K$ equal sized bins. Then I compute the stated probabilities for each bin, and using them I get estimates $G_1(S^k)$ of $\tilde\Phi\Big(S_i\Big)$ and $G_2(S^k)$ of $\tilde\Phi\Big(S_i v(2)\Big)$, where $S^k$ denotes the rightmost edge of a population bin $k$. Then, I construct my estimate of $\tilde\Phi(S_i)$ as a piece-wise linear function going thrugh the estimates $G_1(S^k)$. Then, motivated by what I just showed, I invert the estimates $G_2(S^k)$ according to:

\[
\hat{v(2)}(S^k) = \frac{\tilde\Phi^{-1}\Big(G_2(S^k)\Big)}{S^k}
\]

Finally, I obtain $\hat{v(2)}$ by taking a weighted average over $\hat{v(2)}(S^k)$ where the weights are given by the number of counties per bin. My estimate of $v(2)$ is equal to $0.357$. A graphical report of the results for the case using 7 bins is below:

![]("../output/figure_1")

## (f) How do your results in (e) compare to those in (a)? What does this suggest about the importance of the normality assumption on Fi?

The estimated $v(2)$ with the normality assumption is $20\%$ smaller than with the non-parametric procedure described. Therefore, the normality assumption leads us to overstate degree of competition in a duopoly relative to a monopoly.

