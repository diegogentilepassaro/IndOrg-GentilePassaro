iteration < iteration + 1
name <- paste(factor_var1_name, "_", i, sep = "")
condition <- as.numeric(factor_var1 == i)
assign(name, condition)
factor_matrix[,length(unique(factor_var1))] <- get(name)
}
}
nbr_regressors = dim(X)[2]
betas = solve(t(X)%*%X) %*% (t(X) %*% y)
y_hat <- X%*%betas
residuals = y - y_hat
df <- (nbr_obs_y - nbr_regressors)^(-1)
sigma_sq <- as.numeric(t(residuals) %*% residuals)
sxx <- solve(t(X)%*%X);
var_betas <- (df * sigma_sq) * sxx
se_betas <- sqrt(diag(var_betas))
summary <- rbind(t(betas), se_betas)
rownames(summary) <- c("betas", "se_betas")
return_list <- list("betas" = betas, "se" = se_betas, "summary" = summary,
"predicted" = y_hat, "residuals" = residuals)
return(factor_matrix)
}
n <- 100
y <- rnorm(n, mean = 3, sd = 1)
x1 <- rnorm(n, mean = 15, sd = 5)
x1 <- as.integer(x1)
x2 <- rnorm(n, mean = 1, sd = 2)
X <- cbind(x2)
test_reg <- ols_reg(y,X, factor_var1 = x1, factor_var1_name = "x1")
test_reg
ols_reg <- function (y, X, cons = TRUE, factor_var1 = NULL, factor_var1_name = NULL,
factor_var2 = NULL, factor_var2_name = NULL, display_factors = FALSE) {
vector.assertion <- is.vector(y)
matrix.assertion <- is.matrix(X)
if (vector.assertion == FALSE | matrix.assertion == FALSE) {
print("y needs to be a vector and X a matrix")
break
}
nbr_obs_y <- length(y)
if (cons == TRUE) {
cons <- rep(1,nbr_obs_y)
X <- cbind(X, cons)
}
if (is.null(factor_var1) == FALSE){
factor1.vector.assertion <- is.vector(factor_var1)
if (factor1.vector.assertion == FALSE){
print("factor_var1 should be a vector")
break
}
iteration <- 0
factor_matrix <- matrix(, nrow = nbr_obs_y, ncol = length(unique(factor_var1)))
for(i in unique(factor_var1)){
iteration < as.numeric(iteration + 1)
name <- paste(factor_var1_name, "_", i, sep = "")
condition <- as.numeric(factor_var1 == i)
assign(name, condition)
factor_matrix[,iteration] <- get(name)
}
}
nbr_regressors = dim(X)[2]
betas = solve(t(X)%*%X) %*% (t(X) %*% y)
y_hat <- X%*%betas
residuals = y - y_hat
df <- (nbr_obs_y - nbr_regressors)^(-1)
sigma_sq <- as.numeric(t(residuals) %*% residuals)
sxx <- solve(t(X)%*%X);
var_betas <- (df * sigma_sq) * sxx
se_betas <- sqrt(diag(var_betas))
summary <- rbind(t(betas), se_betas)
rownames(summary) <- c("betas", "se_betas")
return_list <- list("betas" = betas, "se" = se_betas, "summary" = summary,
"predicted" = y_hat, "residuals" = residuals)
return(factor_matrix)
}
n <- 100
y <- rnorm(n, mean = 3, sd = 1)
x1 <- rnorm(n, mean = 15, sd = 3)
x1 <- as.integer(x1)
x2 <- rnorm(n, mean = 1, sd = 2)
X <- cbind(x2)
test_reg <- ols_reg(y,X, factor_var1 = x1, factor_var1_name = "x1")
test_reg
ols_reg <- function (y, X, cons = TRUE, factor_var1 = NULL, factor_var1_name = NULL,
factor_var2 = NULL, factor_var2_name = NULL, display_factors = FALSE) {
vector.assertion <- is.vector(y)
matrix.assertion <- is.matrix(X)
if (vector.assertion == FALSE | matrix.assertion == FALSE) {
print("y needs to be a vector and X a matrix")
break
}
nbr_obs_y <- length(y)
if (cons == TRUE) {
cons <- rep(1,nbr_obs_y)
X <- cbind(X, cons)
}
if (is.null(factor_var1) == FALSE){
factor1.vector.assertion <- is.vector(factor_var1)
if (factor1.vector.assertion == FALSE){
print("factor_var1 should be a vector")
break
}
factor_matrix <- matrix(NA, nrow = nbr_obs_y, ncol = length(unique(factor_var1)))
for(i in unique(factor_var1)){
name <- paste(factor_var1_name, "_", i, sep = "")
condition <- as.numeric(factor_var1 == i)
assign(name, condition)
factor_matrix[,1] <- get(name)
}
}
nbr_regressors = dim(X)[2]
betas = solve(t(X)%*%X) %*% (t(X) %*% y)
y_hat <- X%*%betas
residuals = y - y_hat
df <- (nbr_obs_y - nbr_regressors)^(-1)
sigma_sq <- as.numeric(t(residuals) %*% residuals)
sxx <- solve(t(X)%*%X);
var_betas <- (df * sigma_sq) * sxx
se_betas <- sqrt(diag(var_betas))
summary <- rbind(t(betas), se_betas)
rownames(summary) <- c("betas", "se_betas")
return_list <- list("betas" = betas, "se" = se_betas, "summary" = summary,
"predicted" = y_hat, "residuals" = residuals)
return(factor_matrix)
}
n <- 100
y <- rnorm(n, mean = 3, sd = 1)
x1 <- rnorm(n, mean = 15, sd = 3)
x1 <- as.integer(x1)
x2 <- rnorm(n, mean = 1, sd = 2)
X <- cbind(x2)
test_reg <- ols_reg(y,X, factor_var1 = x1, factor_var1_name = "x1")
test_reg
ols_reg <- function (y, X, cons = TRUE, factor_var1 = NULL, factor_var1_name = NULL,
factor_var2 = NULL, factor_var2_name = NULL, display_factors = FALSE) {
vector.assertion <- is.vector(y)
matrix.assertion <- is.matrix(X)
if (vector.assertion == FALSE | matrix.assertion == FALSE) {
print("y needs to be a vector and X a matrix")
break
}
nbr_obs_y <- length(y)
if (cons == TRUE) {
cons <- rep(1,nbr_obs_y)
X <- cbind(X, cons)
}
if (is.null(factor_var1) == FALSE){
factor1.vector.assertion <- is.vector(factor_var1)
if (factor1.vector.assertion == FALSE){
print("factor_var1 should be a vector")
break
}
factor_matrix <- matrix(NA, nrow = nbr_obs_y, ncol = length(unique(factor_var1)))
for(i in unique(factor_var1)){
name <- paste(factor_var1_name, "_", i, sep = "")
condition <- as.numeric(factor_var1 == i)
assign(name, condition)
factor_matrix[,1] <- get(name)
}
}
nbr_regressors = dim(X)[2]
betas = solve(t(X)%*%X) %*% (t(X) %*% y)
y_hat <- X%*%betas
residuals = y - y_hat
df <- (nbr_obs_y - nbr_regressors)^(-1)
sigma_sq <- as.numeric(t(residuals) %*% residuals)
sxx <- solve(t(X)%*%X);
var_betas <- (df * sigma_sq) * sxx
se_betas <- sqrt(diag(var_betas))
summary <- rbind(t(betas), se_betas)
rownames(summary) <- c("betas", "se_betas")
return_list <- list("betas" = betas, "se" = se_betas, "summary" = summary,
"predicted" = y_hat, "residuals" = residuals)
return(factor_matrix)
}
n <- 100
y <- rnorm(n, mean = 3, sd = 1)
x1 <- rnorm(n, mean = 15, sd = 1)
x1 <- as.integer(x1)
x2 <- rnorm(n, mean = 1, sd = 2)
X <- cbind(x2)
test_reg <- ols_reg(y,X, factor_var1 = x1, factor_var1_name = "x1")
test_reg
unique(x1)
x1
as.numeric(x1 == 15
)
ols_reg <- function (y, X, cons = TRUE, factor_var1 = NULL, factor_var1_name = NULL,
factor_var2 = NULL, factor_var2_name = NULL, display_factors = FALSE) {
vector.assertion <- is.vector(y)
matrix.assertion <- is.matrix(X)
if (vector.assertion == FALSE | matrix.assertion == FALSE) {
print("y needs to be a vector and X a matrix")
break
}
nbr_obs_y <- length(y)
if (cons == TRUE) {
cons <- rep(1,nbr_obs_y)
X <- cbind(X, cons)
}
if (is.null(factor_var1) == FALSE){
factor1.vector.assertion <- is.vector(factor_var1)
if (factor1.vector.assertion == FALSE){
print("factor_var1 should be a vector")
break
}
factor_matrix <- matrix(NA, nrow = nbr_obs_y, ncol = length(unique(factor_var1)))
for(i in unique(factor_var1)){
name <- paste(factor_var1_name, "_", i, sep = "")
condition <- as.numeric(factor_var1 == i)
assign(name, condition)
factor_matrix[,1] <- get(name)
}
}
nbr_regressors = dim(X)[2]
betas = solve(t(X)%*%X) %*% (t(X) %*% y)
y_hat <- X%*%betas
residuals = y - y_hat
df <- (nbr_obs_y - nbr_regressors)^(-1)
sigma_sq <- as.numeric(t(residuals) %*% residuals)
sxx <- solve(t(X)%*%X);
var_betas <- (df * sigma_sq) * sxx
se_betas <- sqrt(diag(var_betas))
summary <- rbind(t(betas), se_betas)
rownames(summary) <- c("betas", "se_betas")
return_list <- list("betas" = betas, "se" = se_betas, "summary" = summary,
"predicted" = y_hat, "residuals" = residuals)
return(factor_matrix)
}
n <- 100
y <- rnorm(n, mean = 3, sd = 1)
x1 <- rnorm(n, mean = 15, sd = 1)
x1 <- as.integer(x1)
x2 <- rnorm(n, mean = 1, sd = 2)
X <- cbind(x2)
test_reg <- ols_reg(y,X, factor_var1 = x1, factor_var1_name = "x1")
test_reg
as.numeric(x1 == 15)
assign("x1_15", as.numeric(x1 == 15) )
x1_15
get(x1_15)
get("x1_15")
for(i in unique(xi)){}
for(i in unique(x1)){print(i)}
ols_reg <- function (y, X, cons = TRUE, factor_var1 = NULL, factor_var1_name = NULL,
factor_var2 = NULL, factor_var2_name = NULL, display_factors = FALSE) {
vector.assertion <- is.vector(y)
matrix.assertion <- is.matrix(X)
if (vector.assertion == FALSE | matrix.assertion == FALSE) {
print("y needs to be a vector and X a matrix")
break
}
nbr_obs_y <- length(y)
if (cons == TRUE) {
cons <- rep(1,nbr_obs_y)
X <- cbind(X, cons)
}
if (is.null(factor_var1) == FALSE){
factor1.vector.assertion <- is.vector(factor_var1)
if (factor1.vector.assertion == FALSE){
print("factor_var1 should be a vector")
break
}
factor_matrix <- matrix(NA, nrow = nbr_obs_y, ncol = length(unique(factor_var1)))
for(i in unique(factor_var1)){
name <- paste(factor_var1_name, "_", i, sep = "")
condition <- as.numeric(factor_var1 == i)
assign(name, condition)
factor_matrix[,1] <- get(name)
}
}
nbr_regressors = dim(X)[2]
betas = solve(t(X)%*%X) %*% (t(X) %*% y)
y_hat <- X%*%betas
residuals = y - y_hat
df <- (nbr_obs_y - nbr_regressors)^(-1)
sigma_sq <- as.numeric(t(residuals) %*% residuals)
sxx <- solve(t(X)%*%X);
var_betas <- (df * sigma_sq) * sxx
se_betas <- sqrt(diag(var_betas))
summary <- rbind(t(betas), se_betas)
rownames(summary) <- c("betas", "se_betas")
return_list <- list("betas" = betas, "se" = se_betas, "summary" = summary,
"predicted" = y_hat, "residuals" = residuals)
return(factor_matrix)
}
n <- 100
y <- rnorm(n, mean = 3, sd = 1)
x1 <- rnorm(n, mean = 15, sd = 1)
x1 <- as.integer(x1)
x2 <- rnorm(n, mean = 1, sd = 2)
X <- cbind(x2)
test_reg <- ols_reg(y,X, factor_var1 = x2, factor_var1_name = "x1")
test_reg
(x1 - floor(x1)) == 0
ols_reg <- function (y, X, cons = TRUE, factor_var1 = NULL, factor_var1_name = NULL,
factor_var2 = NULL, factor_var2_name = NULL, display_factors = FALSE) {
vector.assertion <- is.vector(y)
matrix.assertion <- is.matrix(X)
if (vector.assertion == FALSE | matrix.assertion == FALSE) {
print("y needs to be a vector and X a matrix")
break
}
nbr_obs_y <- length(y)
if (cons == TRUE) {
cons <- rep(1,nbr_obs_y)
X <- cbind(X, cons)
}
if (is.null(factor_var1) == FALSE){
factor1.vector.assertion <- is.vector(factor_var1)
if (factor1.vector.assertion == FALSE){
print("factor_var1 should be a vector")
break
}
if (all(factor_var1 = floor(factor_var1))){
print("every element of vector factor_var1 should be an integer")
break
}
factor_matrix <- matrix(NA, nrow = nbr_obs_y, ncol = length(unique(factor_var1)))
for(i in unique(factor_var1)){
name <- paste(factor_var1_name, "_", i, sep = "")
condition <- as.numeric(factor_var1 == i)
assign(name, condition)
factor_matrix[,1] <- get(name)
}
}
nbr_regressors = dim(X)[2]
betas = solve(t(X)%*%X) %*% (t(X) %*% y)
y_hat <- X%*%betas
residuals = y - y_hat
df <- (nbr_obs_y - nbr_regressors)^(-1)
sigma_sq <- as.numeric(t(residuals) %*% residuals)
sxx <- solve(t(X)%*%X);
var_betas <- (df * sigma_sq) * sxx
se_betas <- sqrt(diag(var_betas))
summary <- rbind(t(betas), se_betas)
rownames(summary) <- c("betas", "se_betas")
return_list <- list("betas" = betas, "se" = se_betas, "summary" = summary,
"predicted" = y_hat, "residuals" = residuals)
return(factor_matrix)
}
n <- 100
y <- rnorm(n, mean = 3, sd = 1)
x1 <- rnorm(n, mean = 15, sd = 1)
x1 <- as.integer(x1)
x2 <- rnorm(n, mean = 1, sd = 2)
X <- cbind(x2)
test_reg <- ols_reg(y,X, factor_var1 = x1, factor_var1_name = "x1")
test_reg
ols_reg <- function (y, X, cons = TRUE, factor_var1 = NULL, factor_var1_name = NULL,
factor_var2 = NULL, factor_var2_name = NULL, display_factors = FALSE) {
vector.assertion <- is.vector(y)
matrix.assertion <- is.matrix(X)
if (vector.assertion == FALSE | matrix.assertion == FALSE) {
print("y needs to be a vector and X a matrix")
break
}
nbr_obs_y <- length(y)
if (cons == TRUE) {
cons <- rep(1,nbr_obs_y)
X <- cbind(X, cons)
}
if (is.null(factor_var1) == FALSE){
factor1.vector.assertion <- is.vector(factor_var1)
if (factor1.vector.assertion == FALSE){
print("factor_var1 should be a vector")
break
}
if (all(factor_var1 == floor(factor_var1))){
print("every element of vector factor_var1 should be an integer")
break
}
factor_matrix <- matrix(NA, nrow = nbr_obs_y, ncol = length(unique(factor_var1)))
for(i in unique(factor_var1)){
name <- paste(factor_var1_name, "_", i, sep = "")
condition <- as.numeric(factor_var1 == i)
assign(name, condition)
factor_matrix[,1] <- get(name)
}
}
nbr_regressors = dim(X)[2]
betas = solve(t(X)%*%X) %*% (t(X) %*% y)
y_hat <- X%*%betas
residuals = y - y_hat
df <- (nbr_obs_y - nbr_regressors)^(-1)
sigma_sq <- as.numeric(t(residuals) %*% residuals)
sxx <- solve(t(X)%*%X);
var_betas <- (df * sigma_sq) * sxx
se_betas <- sqrt(diag(var_betas))
summary <- rbind(t(betas), se_betas)
rownames(summary) <- c("betas", "se_betas")
return_list <- list("betas" = betas, "se" = se_betas, "summary" = summary,
"predicted" = y_hat, "residuals" = residuals)
return(factor_matrix)
}
n <- 100
y <- rnorm(n, mean = 3, sd = 1)
x1 <- rnorm(n, mean = 15, sd = 1)
x1 <- as.integer(x1)
x2 <- rnorm(n, mean = 1, sd = 2)
X <- cbind(x2)
test_reg <- ols_reg(y,X, factor_var1 = x1, factor_var1_name = "x1")
test_reg
x1
ols_reg <- function (y, X, cons = TRUE, factor_var1 = NULL, factor_var1_name = NULL,
factor_var2 = NULL, factor_var2_name = NULL, display_factors = FALSE) {
vector.assertion <- is.vector(y)
matrix.assertion <- is.matrix(X)
if (vector.assertion == FALSE | matrix.assertion == FALSE) {
print("y needs to be a vector and X a matrix")
break
}
nbr_obs_y <- length(y)
if (cons == TRUE) {
cons <- rep(1,nbr_obs_y)
X <- cbind(X, cons)
}
if (is.null(factor_var1) == FALSE){
factor1.vector.assertion <- is.vector(factor_var1)
if (factor1.vector.assertion == FALSE){
print("factor_var1 should be a vector")
break
}
if (all(factor_var1 == floor(factor_var1))){
print("every element of vector factor_var1 should be an integer")
break
}
factor_matrix <- matrix(NA, nrow = nbr_obs_y, ncol = length(unique(factor_var1)))
for(i in unique(factor_var1)){
name <- paste(factor_var1_name, "_", i, sep = "")
condition <- as.numeric(factor_var1 == i)
assign(name, condition)
factor_matrix[,1] <- get(name)
}
}
nbr_regressors = dim(X)[2]
betas = solve(t(X)%*%X) %*% (t(X) %*% y)
y_hat <- X%*%betas
residuals = y - y_hat
df <- (nbr_obs_y - nbr_regressors)^(-1)
sigma_sq <- as.numeric(t(residuals) %*% residuals)
sxx <- solve(t(X)%*%X);
var_betas <- (df * sigma_sq) * sxx
se_betas <- sqrt(diag(var_betas))
summary <- rbind(t(betas), se_betas)
rownames(summary) <- c("betas", "se_betas")
return_list <- list("betas" = betas, "se" = se_betas, "summary" = summary,
"predicted" = y_hat, "residuals" = residuals)
return(factor_matrix)
}
n <- 100
y <- rnorm(n, mean = 3, sd = 1)
x1 <- rnorm(n, mean = 15, sd = 1)
x1 <- as.integer(x1)
x2 <- rnorm(n, mean = 1, sd = 2)
X <- cbind(x2)
test_reg <- ols_reg(y,X, factor_var1 = x1, factor_var1_name = "x1")
test_reg
length(unique(x1))
ols_reg <- function (y, X, cons = TRUE, factor_var1 = NULL, factor_var1_name = NULL,
factor_var2 = NULL, factor_var2_name = NULL, display_factors = FALSE) {
vector.assertion <- is.vector(y)
matrix.assertion <- is.matrix(X)
if (vector.assertion == FALSE | matrix.assertion == FALSE) {
print("y needs to be a vector and X a matrix")
break
}
nbr_obs_y <- length(y)
if (cons == TRUE) {
cons <- rep(1,nbr_obs_y)
X <- cbind(X, cons)
}
if (is.null(factor_var1) == FALSE){
factor1.vector.assertion <- is.vector(factor_var1)
if (factor1.vector.assertion == FALSE){
print("factor_var1 should be a vector")
break
}
if (all(factor_var1 == floor(factor_var1))){
print("every element of vector factor_var1 should be an integer")
break
}
factor_matrix <- matrix(NA, nrow = nbr_obs_y, ncol = length(unique(factor_var1)))
for(i in unique(factor_var1)){
name <- paste(factor_var1_name, "_", i, sep = "")
condition <- as.numeric(factor_var1 == i)
assign(name, condition)
factor_matrix[,1] <- get(name)
}
}
nbr_regressors = dim(X)[2]
betas = solve(t(X)%*%X) %*% (t(X) %*% y)
y_hat <- X%*%betas
residuals = y - y_hat
df <- (nbr_obs_y - nbr_regressors)^(-1)
sigma_sq <- as.numeric(t(residuals) %*% residuals)
sxx <- solve(t(X)%*%X);
var_betas <- (df * sigma_sq) * sxx
se_betas <- sqrt(diag(var_betas))
summary <- rbind(t(betas), se_betas)
rownames(summary) <- c("betas", "se_betas")
return_list <- list("betas" = betas, "se" = se_betas, "summary" = summary,
"predicted" = y_hat, "residuals" = residuals)
return(factor_matrix)
}
n <- 100
y <- rnorm(n, mean = 3, sd = 1)
x1 <- rnorm(n, mean = 15, sd = 1)
x1 <- as.integer(x1)
x2 <- rnorm(n, mean = 1, sd = 2)
X <- cbind(x2)
test_reg <- ols_reg(y,X)
test_reg
